C51 COMPILER V9.54   MAIN                                                                  01/30/2024 16:08:08 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: F:\Keil5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main.l
                    -st) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGF51RC.H>
   2          #include "Delay.h"
   3          #include "Key.h"
   4          #include "I2C.h"
   5          #include "AT24C02.h"
   6          #include "Seg.h"
   7          #include "Timer.h"
   8          
   9          unsigned char Keynumber, runflag;
  10          unsigned char minute, second, msecond;
  11          
  12          int main()
  13          {
  14   1              Timer_Init();
  15   1              while(1)
  16   1              {
  17   2                      Keynumber = Key();
  18   2                      
  19   2                      if(Keynumber == 1) runflag = !runflag;
  20   2                      
  21   2                      if(Keynumber == 2)
  22   2                      {
  23   3                              minute = 0;
  24   3                              second = 0;
  25   3                              msecond = 0;
  26   3                      }
  27   2                      
  28   2                      if(Keynumber == 3)
  29   2                      {
  30   3                              AT24C02_WriteByte(0, minute);
  31   3                              Delay(5);
  32   3                              AT24C02_WriteByte(1, second);
  33   3                              Delay(5);
  34   3                              AT24C02_WriteByte(2, msecond);
  35   3                              Delay(5);
  36   3                      }
  37   2                      
  38   2                      if(Keynumber == 4)
  39   2                      {
  40   3                              minute = AT24C02_ReadByte(0);
  41   3                              second = AT24C02_ReadByte(1);
  42   3                              msecond = AT24C02_ReadByte(2);
  43   3                      }
  44   2                      
  45   2                      Seg_SetBuf(1, minute/10);
  46   2                      Seg_SetBuf(2, minute%10);
  47   2                      
  48   2                      Seg_SetBuf(3, 11);
  49   2                      
  50   2                      Seg_SetBuf(4, second/10);
  51   2                      Seg_SetBuf(5, second%10);
  52   2                      
  53   2                      Seg_SetBuf(6, 11);
  54   2                      
C51 COMPILER V9.54   MAIN                                                                  01/30/2024 16:08:08 PAGE 2   

  55   2                      Seg_SetBuf(7, msecond/10);
  56   2                      Seg_SetBuf(8, msecond%10);
  57   2              }
  58   1      }
  59          
  60          void Set_Loop()
  61          {
  62   1              if(runflag)
  63   1              {
  64   2                      msecond ++;
  65   2                      if(msecond >= 100)
  66   2                      {
  67   3                              msecond = 0;
  68   3                              second ++;
  69   3                              if(second >= 60)
  70   3                              {
  71   4                                      second = 0;
  72   4                                      minute ++;
  73   4                                      if(minute >= 60) minute = 0;
  74   4                              }
  75   3                      }
  76   2              }
  77   1      }
  78          
  79          unsigned int Count1, Count2, Count3;
  80          void hanser() interrupt 1
  81          {
  82   1              TL0 = 0x66;     
  83   1              TH0 = 0xFC;     
  84   1              Count1++;
  85   1              if(Count1 >= 20) // 去除按键消抖的 Delay, while
  86   1              {
  87   2                      Count1 = 0;
  88   2                      Key_loop(); // 驱动函数, 循环函数
*** WARNING C206 IN LINE 88 OF main.c: 'Key_loop': missing function-prototype
  89   2              }
  90   1              Count2++;
  91   1              if(Count2 >= 2) // 为了动态扫描时, 主函数可以执行耗时长的操作
  92   1              {
  93   2                      Count2 = 0;
  94   2                      Seg_Loop();
  95   2              }
  96   1              Count3++;
  97   1              if(Count3 >= 10) // 秒表计数
  98   1              {
  99   2                      Count3 = 0;
 100   2                      Set_Loop();
 101   2              }
 102   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    410    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
